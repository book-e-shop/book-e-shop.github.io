# Лабораторная работа 7. Углубленная работа с данными
# Лабораторная работа 8. Лабораторная работа 8. Переделываем результат 5 ЛР (CRUD 2 таблиц) на ajax и работу в режиме single page application.
[Ссылка на github (дамп базы там же)](https://github.com/book-e-shop/book-e-shop/)

## [Структура данных](https://github.com/book-e-shop/book-e-shop.github.io/blob/master/img/lab5/db.png)

<img  src = "img/lab5/db.png">

## Сценарии работы и представления

####  Корзина. Сценарии работы.

1. Авторизованному пользователю предоставляется возможность добавления книг в корзину.
2. Нажав на книгу, пользователь попадает на отдельную старницу книги, где присутствует кнопка "Добавить".
3. При нажатии на кнопку выбранная книга попадает в корзину.
4. Чтобы попасть в корзину, необходимо нажать значок корзины в верхней части страницы.
5. При необходимости существует возможность редактировать содержимое будущего заказа.

Технически, корзина представляет собой php-массив, который хранится в переменной **$_SESSION** и содержит **id** добавленных в корзину книг.

##### Скринкаст добавления товаров в корзину

####  Таблица "Заказы". Сценарии работы.

1. Для оформления заказа необходимо нажать кнопку "Оформить заказ" в корзине. 
2. После этого откроется форма оформления заказа. В поля Фамилия, Отчество, Почта автоматически подтянулся данные из таблицы **users** для текущего авторизованного пользователя. Самостоятельно необходимо будет указать адрес доставки и выбрать способ оплаты, если не устраивает текущий.
3. Для заверешения оформления заказа необходимо нажать кнопку "Оформить заказ". После этого в таблицу **orders** будут добавлены данные о заказе.
4. Увидеть заказа пользователя можно в личном кабинете.

##### Скринкаст оформления заказа

####  Таблица "Комментарии". Сценарии работы.
Авторизованные пользователи могут писать комментарии для книг.

* На странице с отдельной книгой отображаются все комментарии, оставленные для этой книги.
* Для добавления комментария необходимо написать тескт в соответсвующем поле и нажать кнопку "Добавить".
* Если пользователь авторизован, то отображаются две кнопки "Удалить" и "Редактировать".
* Для удаления комментария необходимо нажать на кнопку "Удалить".
* Текстовое поля для редактирования комментария становится активным после нажатия на кнопку "Редактировать".Для подтверждения изменений нажать на появившуюся кнопку "Обновить".


##### Скринкаст работы
<video  muted controls  width="800" height="450" src = "videos/lab7-8/comments.mp4"></video>


####  Таблица "Рейтинг". Сценарии работы.
Авторизованные пользователи могут ставить оценки для книг.

* Для добавления оценки необходимо установить галочку в check box, который соответствует оценке.
* Для удаление оценки необходимо снять ранее установленную галочку.
* Для изменении оценки необходимо установить галочку в check box, который соответствует новой оценке.
* Для отображение рейтинга книги используется два блока:
    1. Первый блок отображает среднюю оценку для книги. Оценка вычисляется по формуле:  Сумма оценок для книги/Количество оценок для книги .
    2. Второй блок отображает распределение оценок для книги.

##### Скринкаст работы
<video  muted controls  width="800" height="450" src = "videos/lab7-8/rating.mp4"></video>


####  Таблица "Логи". Сценарии работы.
Для отслеживания действий пользователся используется таблица "Логи".


## Отчеты

 